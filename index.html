<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-WJ5LN7PH');</script>
    <!-- End Google Tag Manager -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body.blackout {
            background-color: black;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
    </style>
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>
<body class="theme purple-theme">
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WJ5LN7PH"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    
    <div id="modal-background" class="modal"></div>
    

    <div class="flex flex-row justify-center items-center margin-0 mx-auto flex-wrap md:flex-nowrap">
        <div class="flex flex-col">

            <div class="flex self-center">
                <h1 class="upheaval text-5xl md:text-6xl shadow-theme text-white flex">ISAA<span class="">CONNECT</span></h1>
            </div>

            <div class="flex flex-row">
                <div  class="shadow-theme flex flex-col justify-center items-center p-4 m-4 mb-0 border-4 text-center bg-paper rounded-3xl" id="cards-game">
                    <div id="cards-win">
                        <ol class="solved-groups">
                            
                        </ol>
                    </div>
                    <div id="cards-module" class="cards-module grid grid-cols-4 gap-4">
                    </div>
                </div>
                
                <div id="modal-wrapper"></div>

            </div>

            <section class="buttons flex justify-evenly mt-4">
                <button type="button" data-id="submit" class="shadow-theme text-dark font-bold py-2 px-4 rounded-xl button--submit button--disabled" disabled>
                    Submit
                </button>
                <section class="health flex justify-between upheaval">
                    <span class="flex ml-2 items-between hearts">
                    </span>
                </section>
            </section>
        </div>

        <div class="flex flex-col gap-4 items-center">
            <button type="button" data-id="shuffle" class="shadow-theme text-white font-bold p-3 rounded-full">
                <span class="material-symbols-outlined align-bottom">
                    shuffle
                    </span>
            </button>
            <button type="button" data-id="shuffle" onclick="background();" class="shadow-theme text-white font-bold p-3">
                <span class="material-symbols-outlined align-bottom">
                    shuffle
                    </span>
            </button>
        </div>

    </div>
</body>

<script src="//cdnjs.cloudflare.com/ajax/libs/seedrandom/3.0.5/lib/alea.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script>
<script type="module" src="/modals.js"></script>
<script type="module" src="/index.js"></script>
<script>
    function numberWithLeadingZeros(number, length = 3)
    {
        while (number.toString().length < length)
        {
            number = '0' + number;
        }

        return number;
    }

    function background()
    {
        let body = document.querySelector('body');
        let theme = body.classList[1];
        let themes = ['purple-theme', 'main-theme'];
        let index = themes.indexOf(theme);
        index = (index + 1) % themes.length;
        body.classList.remove(theme);
        body.classList.add(themes[index]);
    }

    function removeCookies()
    {
        Object.keys(Cookies.get()).forEach(function(cookieName) {
            Cookies.remove(cookieName);
        });
    }

    function copyResult()
    {
        const title = document.querySelector('[data-id="results--title"]');
        const result = document.querySelector('[data-id="results"]');

        let textToCopy = title.textContent + "\n";

        let health = Cookies.get("health");
        if (health === undefined)
        {
            health = document.querySelectorAll('[data-type="health"]').length;
        }
        textToCopy += `❤️: ${health} 💔: ${5 - health}\n`;
        
        result.childNodes.forEach((node, index) => {
            items = document.querySelectorAll(`[data-id^="results-attempt${index}-"]`);
            items.forEach(item => {
                let indexGroup = + item.getAttribute('data-id').split('-group')[1];
                switch (indexGroup)
                {
                    case 0:
                        textToCopy += "🟥";
                        break;
                    case 1:
                        textToCopy += "🟦";
                        break;
                    case 2:
                        textToCopy += "🟩";
                        break;
                    case 3:
                        textToCopy += "🟪";
                        break;
                }
            });
            textToCopy += "\n";
        });

        navigator.clipboard.writeText(textToCopy);
    }
</script>
<script>
    function getTimeRemaining() {
        const now = new Date();
        const target = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1, 8, 0, 0, 0);
        const timeRemaining = target - now;
        
        const seconds = Math.floor((timeRemaining / 1000) % 60);
        const minutes = Math.floor((timeRemaining / 1000 / 60) % 60);
        const hours = Math.floor((timeRemaining / (1000 * 60 * 60)) % 24);
        
        return {
            total: timeRemaining,
            hours: hours,
            minutes: minutes,
            seconds: seconds
        };
    }
    
    function updateCountdown() {
        const countdownElement = document.querySelectorAll('.countdown');
        
        const timeRemaining = getTimeRemaining();
        
        countdownElement.forEach(element => {
            element.textContent = `${numberWithLeadingZeros(timeRemaining.hours, 2)} : ${numberWithLeadingZeros(timeRemaining.minutes, 2)} : ${numberWithLeadingZeros(timeRemaining.seconds, 2)}`;
        });
        
        if (timeRemaining.total <= 0) {
            clearInterval(countdownInterval);
            location.reload();
        }
    }
    
    const countdownInterval = setInterval(updateCountdown, 1000);
</script>
<script>
    "use strict";
    let cookie = Cookies.get("background");
    if (!cookie) {
        Cookies.set("background", "basement");
    }
    else {
        let background = document.getElementById("background");
        background.src = `/assets/background/${cookie}.jpg`;
    }

    function previewBackground(element) {
        let id = element.getAttribute("data-id");
        let background = document.getElementById("background");
        background.src = `/assets/background/${id}.jpg`;
    }

    function resetBackground(element) {
        let background = document.getElementById("background");
        background.src = `/assets/background/${Cookies.get("background")}.jpg`;
    }

    function applyBackground(element) {
        let id = element.getAttribute("data-id");
        let background = document.getElementById("background");
        background.src = `/assets/background/${id}.jpg`;
        Cookies.set("background", id);
        changeText(id);
    }

    function changeText(background) {
        let texts = document.querySelectorAll(".text-green-500");
        texts.forEach(text => {
            text.classList.remove("text-green-500", "font-semibold", "underline");
        });
        let text = document.querySelector(`[data-id="${background}"]`);
        text.classList.add("text-green-500", "font-semibold", "underline");
    }
</script>
<script>
    (function() {
        const sequence = [52, 56, 49, 53, 49, 54, 50, 51, 52, 50]; // Codes des touches 4, 8, 15, 16, 23, 42
        let position = 0;

        document.addEventListener('keydown', (event) => {
            if (event.keyCode === sequence[position]) {
                position++;
                if (position === sequence.length) {
                    document.body.classList.add('blackout');
                    setTimeout(() => {
                        prompt("Vous avez appuyé sur la séquence correcte !");
                    }, 500);
                }
            } else {
                position = 0;
            }
        });
    })();
</script>
</html>